<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitKit Chat</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <style>
      :root {
        --color-surface: #1f2937;
        --color-border: #374151;
        --color-text-primary: #ffffff;
        --color-text-secondary: #9ca3af;
        --color-primary: #3b82f6;
      }

      body {
        background-color: #111827;
        margin: 0;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      /* Base sidebar styles */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 72px;
        height: 100vh;
        z-index: 1000;
        background-color: var(--color-surface);
        border-right: 1px solid var(--color-border);
        transition: all 0.3s ease;
        padding: 16px 0;
      }

      /* Hide nav text by default (desktop) */
      .nav-text {
        display: none;
      }

      /* Sidebar navigation links */
      .sidebar .nav-link {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 56px;
        margin: 8px;
        border-radius: 10px;
        color: var(--color-text-secondary);
        transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
        text-decoration: none;
      }

      .sidebar .nav-link .bi {
        width: 28px;
        height: 28px;
        font-size: 24px;
      }

      .sidebar .nav-link:hover {
        background-color: rgba(255, 255, 255, 0.05);
        color: var(--color-text-primary);
      }

      .sidebar .nav-link.active {
        background-color: var(--color-primary);
        color: #ffffff;
      }

      /* User dropdown styling */
      .sidebar .dropdown-toggle::after {
        display: none;
      }

      .sidebar .dropdown-menu {
        --bs-dropdown-bg: #2d3748;
        --bs-dropdown-link-color: var(--color-text-primary);
        --bs-dropdown-link-hover-bg: var(--color-primary);
        --bs-dropdown-border-color: var(--color-border);
      }

      .sidebar-footer {
        border-top: 1px solid var(--color-border);
      }

      /* Main content positioning */
      .main-content {
        margin-left: 72px;
        min-height: 100vh;
      }

      #chatMessages.initial-state {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
      }

      #initial-view {
        opacity: 1;
        transition: opacity 0.5s ease;
      }

      #initial-view.fade-out {
        opacity: 0;
      }

      /* Desktop header (always visible on desktop) */
      .desktop-header {
        display: block !important;
      }

      /* Mobile header (hidden by default) */
      .mobile-header {
        display: none !important;
      }

      /* Mobile styles */
      @media (max-width: 767px) {
        .sidebar {
          left: -280px;
          width: 280px;
          padding: 0;
        }

        .sidebar.show {
          left: 0;
        }

        .nav-text {
          display: inline;
        }

        .sidebar .nav-link {
          justify-content: flex-start;
          padding-left: 16px;
          height: 48px;
        }

        .sidebar .nav-link .bi {
          margin-right: 12px;
        }

        .main-content {
          margin-left: 0;
        }

        .mobile-header {
          display: flex !important;
        }

        .desktop-header {
          display: none !important;
        }
      }

      /* Form control focus styling */
      .form-control:focus {
        border-color: #4b5563 !important;
        box-shadow: 0 0 0 0.2rem rgba(59, 130, 246, 0.25) !important;
      }

      /* Mobile overlay */
      .mobile-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 999;
      }

      .mobile-overlay.show {
        display: block;
      }
    </style>
  </head>
  <body>
    <!-- Mobile overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Sidebar -->
    <div class="sidebar d-flex flex-column" id="sidebar">
      <!-- Sidebar header -->
      <div class="sidebar-header">
        <!-- Mobile header -->
        <div
          class="d-flex justify-content-between align-items-center p-3 d-md-none"
        >
          <h4 class="text-white mb-0">GitKit</h4>
          <button
            type="button"
            class="btn-close btn-close-white"
            id="closeSidebar"
          ></button>
        </div>
        <!-- Desktop header -->
        <div class="d-none d-md-block text-center py-3">
          <h5 class="text-white mb-0">GitKit</h5>
        </div>
      </div>

      <!-- Navigation -->
      <ul class="nav nav-pills flex-column flex-grow-1 px-0">
        <li class="nav-item">
          <a href="#" class="nav-link active" data-title="Chat">
            <i class="bi bi-chat-dots"></i>
            <span class="nav-text">Chat</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-title="Dashboard">
            <i class="bi bi-grid-3x3-gap"></i>
            <span class="nav-text">Dashboard</span>
          </a>
        </li>
      </ul>

      <!-- User dropdown -->
      <div class="dropup mt-auto sidebar-footer">
        <a
          href="#"
          class="d-flex align-items-center p-3 text-decoration-none"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <img
            src="https://lh3.googleusercontent.com/a/ACg8ocKsrmWry4M4mlJM8S_IinvlWKxtO0_Mk0U6suZulJJ-LyzpjgvR=s64-cc"
            alt="Profile"
            width="32"
            height="32"
            class="rounded-circle"
          />
          <span class="nav-text text-white ms-2">Monis</span>
        </a>
        <ul class="dropdown-menu dropdown-menu-dark text-small shadow">
          <li><h6 class="dropdown-header">Signed in as Monis</h6></li>
          <li><hr class="dropdown-divider" /></li>
          <li><a class="dropdown-item" href="/logout">Sign out</a></li>
        </ul>
      </div>
    </div>

    <!-- Main content -->
    <div class="main-content d-flex flex-column vh-100">
      <!-- Mobile header -->
      <div
        class="mobile-header p-3 d-flex align-items-center"
        style="background-color: #1f2937; border-bottom: 1px solid #374151"
      >
        <button class="btn btn-outline-light me-3" id="menuToggle">
          <i class="bi bi-list"></i>
        </button>
        <h2 class="text-white mb-0">Chat</h2>
      </div>

      <!-- Desktop header -->
      <header
        class="desktop-header p-2 flex-shrink-0"
        style="background-color: #1f2937; border-bottom: 1px solid #374151"
      >
        <h2 class="ps-2 text-white">Chat</h2>
      </header>

      <!-- Chat messages -->
      <main
        class="flex-grow-1 overflow-y-auto p-4 initial-state"
        id="chatMessages"
      >
        <div id="initial-view">
          <h1 class="text-white">Welcome to GitKit</h1>
          <h3 class="text-secondary">What would you like to create</h3>
        </div>
      </main>

      <!-- Input section -->
      <div class="p-3 flex-shrink-0" style="border-top: 1px solid #374151">
        <div class="input-group">
          <input
            type="text"
            id="userInput"
            placeholder="Click here to start..."
            class="form-control form-control-lg text-white"
            style="
              box-shadow: none !important;
              outline: 0 !important;
              background-color: #374151;
              border-color: #4b5563;
            "
          />
          <button class="btn btn-primary" id="sendBtn">Send</button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Chat functionality
      let chatStarted = false;
      let currentQuestion = 0;
      let projectData = {
        title: "",
        description: "",
        technologies: "",
      };

      const questions = [
        "What is your project title?",
        "Provide a small description of your project.",
        "What technologies and languages do you want to use?",
      ];

      const chatMessages = document.getElementById("chatMessages");
      const userInput = document.getElementById("userInput");
      const sendBtn = document.getElementById("sendBtn");
      const initialView = document.getElementById("initial-view");

      function addMessage(sender, message, isBot = false) {
        const messageDiv = document.createElement("div");
        messageDiv.className = "mb-3";

        const senderDiv = document.createElement("div");
        senderDiv.className = "fw-bold text-white";

        const contentDiv = document.createElement("div");
        contentDiv.className = "d-inline-block p-3 rounded mt-1";
        contentDiv.style.maxWidth = "80%";

        if (isBot) {
          senderDiv.innerHTML = '<i class="bi bi-robot"></i> GitKit';
          contentDiv.className += " text-white";
          contentDiv.style.backgroundColor = "#374151";
        } else {
          senderDiv.innerHTML = '<i class="bi bi-person-fill"></i> You';
          contentDiv.className += " bg-primary text-white ms-auto";
          contentDiv.style.marginLeft = "auto";
          messageDiv.className += " d-flex flex-column align-items-end";
        }

        contentDiv.innerHTML = message;
        messageDiv.appendChild(senderDiv);
        messageDiv.appendChild(contentDiv);
        chatMessages.appendChild(messageDiv);

        // Scroll to bottom
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      function handleUserResponse() {
        if (!chatStarted) return;
        const answer = userInput.value.trim();
        if (!answer) return;

        // Add user message to chat
        addMessage("You", answer, false);

        // Store the answer
        switch (currentQuestion) {
          case 1:
            projectData.title = answer;
            break;
          case 2:
            projectData.description = answer;
            break;
          case 3:
            projectData.technologies = answer;
            break;
        }

        // Clear input
        userInput.value = "";

        // Move to next question or show summary
        setTimeout(() => {
          if (currentQuestion < 3) {
            currentQuestion++;
            addMessage(
              "GitKit",
              `<strong>Question ${currentQuestion}:</strong> ${
                questions[currentQuestion - 1]
              }`,
              true
            );
          } else {
            // Show project summary
            const summary = `
              <strong>Great! Here's your project summary:</strong><br><br>
              <strong>üìù Title:</strong> ${projectData.title}<br>
              <strong>üìã Description:</strong> ${projectData.description}<br>
              <strong>üõ†Ô∏è Technologies:</strong> ${projectData.technologies}<br><br>
              Ready to start building your project!
              <button class="btn btn-primary">Save</button>
            `;
            addMessage("GitKit", summary, true);

            // Disable input after completion
            userInput.placeholder = "Project setup complete!";
            userInput.disabled = true;
            sendBtn.disabled = true;
          }
        }, 1000);
      }

      function startChat() {
        if (chatStarted) return;
        chatStarted = true;
        currentQuestion = 1;
        userInput.placeholder = "Type your answer here...";
        initialView.classList.add("fade-out");
        initialView.addEventListener(
          "transitionend",
          () => {
            initialView.remove();
            chatMessages.classList.remove("initial-state");
            setTimeout(() => {
              addMessage(
                "GitKit",
                `<strong>Question 1:</strong> ${questions[0]}`,
                true
              );
            }, 500);
          },
          { once: true }
        );
      }

      // Event listeners
      sendBtn.addEventListener("click", handleUserResponse);
      userInput.addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
          handleUserResponse();
        }
      });

      userInput.addEventListener("focus", startChat);

      // Mobile sidebar functionality
      const menuToggle = document.getElementById("menuToggle");
      const closeSidebar = document.getElementById("closeSidebar");
      const sidebar = document.getElementById("sidebar");
      const mobileOverlay = document.getElementById("mobileOverlay");

      function openSidebar() {
        sidebar.classList.add("show");
        mobileOverlay.classList.add("show");
        document.body.style.overflow = "hidden";
      }

      function closeSidebarFunc() {
        sidebar.classList.remove("show");
        mobileOverlay.classList.remove("show");
        document.body.style.overflow = "auto";
      }

      if (menuToggle) {
        menuToggle.addEventListener("click", openSidebar);
      }

      if (closeSidebar) {
        closeSidebar.addEventListener("click", closeSidebarFunc);
      }

      if (mobileOverlay) {
        mobileOverlay.addEventListener("click", closeSidebarFunc);
      }

      // Close sidebar on window resize if mobile
      window.addEventListener("resize", function () {
        if (window.innerWidth >= 768) {
          closeSidebarFunc();
        }
      });
    </script>
  </body>
</html>
